<html>
<head> 
    
<link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>   
<script type="text/javascript">
    
// search bar
$(document).ready(function () {
    // domainr api
    var url = "http://domai.nr/api/json/search?q=";
    var query;

    $(".names").delegate(".created", "click", function() {
        query = $(this).text();
        $.getJSON(url+query+"&callback=?", function(json) {
            $('#domains').empty();
            $.each(json.results, function(i, result) {
                var state = result.availability
                if ((state == "taken") || (state == "available") || 
                    (state == "maybe")) {
                    $("#domains").append('<div id ="url' + i + '"class = "urls">' + result.domain + '</div>');
                    if (state == "available") {
                        $("#url"+i).addClass("available");
                    }
                    else if (state == "maybe") {
                        $("#url"+i).addClass("maybe");
                    }
                    else {
                        $("#url"+i).addClass("taken");
                    }
                }
            });
        });
        
        $("#i-three").hide();
        $("#step-three").hide();
        $("#i-four").css("display", "inherit");
        $("#step-four").css("display", "inherit");
    });

    // clicked on a domain, clear all other grays
    $("#domains").delegate(".urls", "click", function() {        
        $(".urls").each(function() {
            $(this).css({'background-color':''});
        });
        $(this).css({'background-color':'#c7c7c7'});
        
    });

    // hovering arrows
    $("#domains").delegate(".urls", "hover", function(event) {
        if (event.type == 'mouseenter') {
            $(".urls").each(function() {    
                $("img", this).remove();
            });
            $(this).append("<img src='arrow.png' />"); 
        }
        else {
            $("img", this).remove();
        }
    });

    // search bar text + activate
	$("#word0").attr("value", "search...");
	$("#word1").attr("value", "search...");
	$("#word2").attr("value", "search...");
	
	var text = "search...";

	$("#word0").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word0").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	$("#word1").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word1").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	$("#word2").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word2").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	
});

// synonyms etc
function makeNames() {
	var group0 = [];
	group0.push([document.getElementById('word0').value, 0, -1]);
	var group1 = [];
	group1.push([document.getElementById('word1').value, 1, -1]);
	var group2 = [];
	group2.push([document.getElementById('word2').value, 2, -1]);
    var type1 = [];
	var i = 0;
	while (i < 4) {
        group0.push([document.getElementById('output0').childNodes[i].innerHTML, 0, i]);
        group1.push([document.getElementById('output1').childNodes[i].innerHTML, 1, i]);
        group2.push([document.getElementById('output2').childNodes[i].innerHTML, 2, i]);
		i++;
	}
	
	type1 = joinify(group0,group1).concat(joinify(group0,group2), joinify(group1, group2));
    permute(type1);

    var output0 = document.getElementById('names0');
    var output1 = document.getElementById('names1');
    var output2 = document.getElementById('names2');
    while (output0.firstChild) {
        output0.removeChild(output0.firstChild);
    }
    while (output1.firstChild) {
        output1.removeChild(output1.firstChild);
    }
    while(output2.firstChild) {
        output2.removeChild(output2.firstChild);
    }
    i = 0;
    while (i < 12 && i < type1.length) {
	    var div = document.createElement('span');
        div.innerHTML = type1[i][0];
        div.setAttribute('class', 'created'); 
        div.addEventListener('mouseover', (function(i) {
            return function() {
                highlight(type1[i][1], type1[i][2], type1[i][3], type1[i][4]);
            };
        })(i));
        div.addEventListener('mouseout', (function(i) {
            return function() {
                unhighlight(type1[i][1], type1[i][2], type1[i][3], type1[i][4]);
            };
            })(i));
        if (i < 4) {
	        output0.appendChild(div);
        }
        else if (i < 8) {
            output1.appendChild(div);
        }
        else {
            output2.appendChild(div);
        }
	    i++;
    }
    $("#output").css("border-top", "1px dotted");
    $("#output").css("border-bottom", "1px dotted");
    document.getElementById('i-two').style.display = 'none';
    document.getElementById('step-two').style.display= 'none';
    if (document.getElementById('i-four').style.display == '') {
        document.getElementById('i-three').style.display = 'inherit';
        document.getElementById('step-three').style.display = 'inherit';
    }
}

function highlight(x1, x2, y1, y2) {
    var color1;
    var color2;
    switch (x1) {
        case 0:
            color1 = 'red';
            break;
        case 1:
            color1 = 'blue';
            break;
        case 2:
            color1 = 'green';
            break;
    }
    switch (y1) {
        case 0:
            color2 = 'red';
            break;
        case 1:
            color2 = 'blue';
            break;
        case 2:
            color2 = 'green';
            break;
    }
    if (x2 == -1) {
        var id = 'word' + x1;
        var word = document.getElementById(id);
        word.style.color = color1;
    }
    else {
        var listname1 = 'output' + x1;
        var list1 = document.getElementById(listname1);
        list1.childNodes[x2].style.color = color1;
    }
    if (y2 == -1) {
        var id = 'word' + y1;
        var word = document.getElementById(id);
        word.style.color = color2;
    }
    else {
        var listname2 = 'output' + y1;
        var list2 = document.getElementById(listname2);
        list2.childNodes[y2].style.color = color2;
    }
}
function unhighlight(x1, x2, y1, y2) {
    if (x2 == -1) {
        var id = 'word' + x1;
        var word = document.getElementById(id);
        word.style.color = 'black';
    }
    else {
        var listname1 = 'output' + x1;
        var list1 = document.getElementById(listname1);
        list1.childNodes[x2].style.color = 'black';
    }
    if (y2 == -1) {
        var id = 'word' + y1;
        var word = document.getElementById(id);
        word.style.color = 'black';
    }
    else {
        var listname2 = 'output' + y1;
        var list2 = document.getElementById(listname2);
        list2.childNodes[y2].style.color = 'black';
    }
}


function joinify(array1, array2) {
	var i = 0;
	var list = [];
	while (i < array1.length) {
		var j = 0;
		while (j < array2.length) {
			var k = 1;
			while (k < 6) {
				var mix1 = mash(array1[i][0], array2[j][0], k, Math.floor(k/2));
				var mix2 = mash(array2[j][0], array1[i][0], k, Math.floor((k-1)/2));
				if (mix1 != false && mix1.length < 15) {
					list.push([mix1, array1[i][1], array1[i][2], array2[j][1], array2[j][2]]);
				}
				if (mix2 != false && mix2.length < 15) {	
					list.push([mix2, array1[i][1], array1[i][2], array2[j][1], array2[j][2]]);
				}
				k++;
			}
		j++;
		}
	i++;
	}
	return list;
}				

function mash(word1, word2, len, err) {
	var len1 = word1.length;
	var len2 = word2.length;

    if (len > len1 || len > len2) {
        return false;
    }
    if (editDistance(word1.substring(len1 - len), word2.substring(0, len)) <= err) {
        if (len1 > len2) {
		    return word1.substring(0, len1 - len) + word2;
        }
        else {
            return word1 + word2.substring(len);
        }
	}
	else {
		return false;
	}
}		

function editDistance(word1, word2) {
    var len1 = word1.length;
    var len2 = word2.length;
    if (len1 != len2) {
        return false;
    }
    else {
        var i = 0;
        var err = 0;
        while (i < len1)
        {
            if(word1[i] != word2[i]) {
                err++;
            }
            i++;
        }
        return err;
    }
}

function getSynonym() {
    var word0 = document.getElementById('word0').value;
    var word1 = document.getElementById('word1').value;
    var word2 = document.getElementById('word2').value;
    var counter = 0;
    if (word0 == 'search...') {
        counter++;
    }
    if (word1 == 'search...') {
        counter++;
    }
    if (word2 == 'search...') {
        counter++;
    }
    if (counter > 1) {
        return;
    }
    var i = 0;
	while (i < 3) {
		makerequest(i);
		i++;
    }
    document.getElementById('i-one').style.display = 'none';
    document.getElementById('step-one').style.display= 'none';
    if (document.getElementById('i-three').style.display == '')
    {
        document.getElementById('i-two').style.display = 'inherit';
        document.getElementById('step-two').style.display = 'inherit';
    }
}
	
function processResponse0(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}


response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div0');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
list.setAttribute('id', 'output0');
list.addEventListener('click', (function() {
    makerequest(0);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
    list.appendChild(item);
    i++;
    }
}

function processResponse1(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}

response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div1');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
list.setAttribute('id', 'output1');
list.addEventListener('click', (function() {
    makerequest(1);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
	list.appendChild(item);
	i++;
	}
}
function processResponse2(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}

response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div2');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
list.setAttribute('id', 'output2');
list.addEventListener('click', (function() {
    makerequest(2);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
	list.appendChild(item);
	i++;
	}
}

function permute(array) {
	var n = array.length - 1;
	while (n > 0) {
		var i = Math.floor(Math.random()*n);
		var temp  = array[n];
		array[n] = array[i];
		array[i] = temp;
		n--;
	}
}

function makerequest(x) {
	var head = document.getElementsByTagName('head')[0];
	var script = document.createElement('script');
	var div = "word" + x;
	var request = 'http://words.bighugelabs.com/api/2/40868e50c339e2dcdaa54d041dffbf88/' + document.getElementById(div).value + '/json?callback=processResponse' + x; 
	script.type = 'text/javascript';
	script.src = request;
	head.appendChild(script);
}

</script>
</head>

<body>
    <div id="header">
        <div id="header-inner">
            <a href="/">Syntext</a>
        </div>
    </div>
    <div id="content">
        <div id="content-left">
            <div id="div0">
            	<div class="word">
            		<input type="text" id = "word0" class = "input"/>
            	</div>
            </div>
            <div id="div1">
            	<div class="word">
            		<input type="text" id="word1" class = "input"/> 
            	</div>
            </div>
            <div id="div2">
            	<div class="word">
            		<input type="text" id="word2" class = "input"/> 
                </div>
            </div>
            <div id="output">
                <div id="names0" class="names">
                </div>
                <div id="names1" class="names">
                </div>
                <div id="names2" class="names">
                </div>
            </div>
            <div id="domains">
            </div>
        </div>
        <div id="content-right">
            <div id="step-one" class="step"> 
                <span class="steptitle">
                    Step One
                </span>
            </div>
            <div id="i-one" class="stepinstructions">
                Give us three words related to your idea.
                <span class="button" onclick="getSynonym()"> 
                    Generate Synonyms! 
                </span>
            </div>
            <div id="step-two" class="step">
                <span class="steptitle">
                    Step Two
                </span>
            </div>
            <div id="i-two" class="stepinstructions">
                <span id="button0" class="button" onclick="getSynonym()"> 
                    Generate Synonyms! 
                </span>
                If you don't like the synonyms, click on a group to generate new ones. Once you're satisfied, click mash words.
                <span class="button" onclick="makeNames()"> 
                    Mash Words! 
                </span>
            </div>
            <div id="step-three" class="step">
                <span class="steptitle">
                    Step Three
                </span>
            </div>
            <div id="i-three" class="stepinstructions">
                <span id="button1" class="button" onclick="getSynonym()"> 
                    Generate Synonyms! 
                </span>
                <span id="button2" class="button" onclick="makeNames()"> 
                    Mash Words! 
                </span>
                Click on a name to see related domain names. If you want to generate more, click mash words again.
            </div>
            <div id="step-four" class="step">
                <span class="steptitle">
                    Step Four
                </span>
            </div>
            <div id="i-four" class="stepinstructions">
                <span id="button3" class="button" onclick="getSynonym()"> 
                    Generate Synonyms! 
                </span>
                <span id="button4" class="button" onclick="makeNames()"> 
                    Mash Words! 
                </span>
                Click on a domain name to see if it is available!
            </div>
        </div>
    </div>
</body>
</html>
