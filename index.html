<html>
<head> 
    
<link rel="stylesheet" type="text/css" href="style.css" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>   
<script type="text/javascript">
// jQuery stuff
$(document).ready(function () {
	// search bar text + activate
	$("#word0").attr("value", "search!");
	$("#word1").attr("value", "search!");
	$("#word2").attr("value", "search!");
	
	var text = "search!";

	$("#word0").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word0").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	$("#word1").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word1").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	$("#word2").focus(function() {
		$(this).addClass("active");
		if($(this).attr("value") == text) $(this).attr("value", "");
	});
	$("#word2").blur(function() {
		if($(this).attr("value") == "") {
			$(this).attr("value", text);
			$(this).removeClass("active");
		}
	});
	
});

// synonyms etc
function makeNames() {
	var group0 = [];
	group0.push([document.getElementById('word0').value, 0, -1]);
	var group1 = [];
	group1.push([document.getElementById('word1').value, 1, -1]);
	var group2 = [];
	group2.push([document.getElementById('word2').value, 2, -1]);
    var type1 = [];
	var i = 0;
	while (i < 4) {
        group0.push([document.getElementById('output0').childNodes[i].innerHTML, 0, i]);
        group1.push([document.getElementById('output1').childNodes[i].innerHTML, 1, i]);
        group2.push([document.getElementById('output2').childNodes[i].innerHTML, 2, i]);
		i++;
	}
	
	type1 = joinify(group0,group1).concat(joinify(group0,group2), joinify(group1, group2));
    permute(type1);

    var output = document.getElementById('output');
    while (output.firstChild) {
        output.removeChild(output.firstChild);
    }
    i = 0;
    while (i < 10) {
	    var div = document.createElement('div');
        div.innerHTML = type1[i][0];
        div.setAttribute('class', 'created'); 
        div.addEventListener('mouseover', (function(i) {
            return function() {
                highlight(type1[i][1], type1[i][2], type1[i][3], type1[i][4]);
            };
        })(i));
        div.addEventListener('mouseout', (function(i) {
            return function() {
                unhighlight(type1[i][1], type1[i][2], type1[i][3], type1[i][4]);
            };
        })(i));
	    output.appendChild(div);
	    i++;
	}
}

function highlight(x1, x2, y1, y2) {
    var color1;
    var color2;
    switch (x1) {
        case 0:
            color1 = 'red';
            break;
        case 1:
            color1 = 'blue';
            break;
        case 2:
            color1 = 'green';
            break;
    }
    switch (y1) {
        case 0:
            color2 = 'red';
            break;
        case 1:
            color2 = 'blue';
            break;
        case 2:
            color2 = 'green';
            break;
    }
    if (x2 == -1) {
        var id = 'word' + x1;
        var word = document.getElementById(id);
        word.style.color = color1;
    }
    else {
        var listname1 = 'output' + x1;
        var list1 = document.getElementById(listname1);
        list1.childNodes[x2].style.color = color1;
    }
    if (y2 == -1) {
        var id = 'word' + y1;
        var word = document.getElementById(id);
        word.style.color = color2;
    }
    else {
        var listname2 = 'output' + y1;
        var list2 = document.getElementById(listname2);
        list2.childNodes[y2].style.color = color2;
    }
}
function unhighlight(x1, x2, y1, y2) {
    if (x2 == -1) {
        var id = 'word' + x1;
        var word = document.getElementById(id);
        word.style.color = 'black';
    }
    else {
        var listname1 = 'output' + x1;
        var list1 = document.getElementById(listname1);
        list1.childNodes[x2].style.color = 'black';
    }
    if (y2 == -1) {
        var id = 'word' + y1;
        var word = document.getElementById(id);
        word.style.color = 'black';
    }
    else {
        var listname2 = 'output' + y1;
        var list2 = document.getElementById(listname2);
        list2.childNodes[y2].style.color = 'black';
    }
}


function joinify(array1, array2) {
	var i = 0;
	var list = [];
	while (i < array1.length) {
		var j = 0;
		while (j < array2.length) {
			var k = 1;
			while (k < 6) {
				var mix1 = mash(array1[i][0], array2[j][0], k, Math.floor(k/2));
				var mix2 = mash(array2[j][0], array1[i][0], k, Math.floor((k-1)/2));
				if (mix1 != false) {
					list.push([mix1, array1[i][1], array1[i][2], array2[j][1], array2[j][2]]);
				}
				if (mix2 != false) {	
					list.push([mix2, array1[i][1], array1[i][2], array2[j][1], array2[j][2]]);
				}
				k++;
			}
		j++;
		}
	i++;
	}
	return list;
}				

function mash(word1, word2, len, err) {
	var len1 = word1.length;
	var len2 = word2.length;

    if (len > len1 || len > len2) {
        return false;
    }
    if (editDistance(word1.substring(len1 - len), word2.substring(0, len)) <= err) {
        if (len1 > len2) {
		    return word1.substring(0, len1 - len) + word2;
        }
        else {
            return word1 + word2.substring(len);
        }
	}
	else {
		return false;
	}
}		

function editDistance(word1, word2) {
    var len1 = word1.length;
    var len2 = word2.length;
    if (len1 != len2) {
        return false;
    }
    else {
        var i = 0;
        var err = 0;
        while (i < len1)
        {
            if(word1[i] != word2[i]) {
                err++;
            }
            i++;
        }
        return err;
    }
}

function getSynonym() {
	var i = 0;
	while (i < 3) {
		makerequest(i);
		i++;
	}
}
	
function processResponse0(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}


response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div0');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
var $list = $(list);
list.setAttribute('id', 'output0');
list.addEventListener('click', (function() {
    makerequest(0);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
    list.appendChild(item);
    i++;
    }
}

function processResponse1(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}

response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div1');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
list.setAttribute('id', 'output1');
list.addEventListener('click', (function() {
    makerequest(1);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
	list.appendChild(item);
	i++;
	}
}
function processResponse2(json){
var response = [];
var verbs = [];
var nouns = [];
var adjectives = [];
var adverbs = [];
if (json.verb != null) {
	verbs = json.verb.syn;
}
if (json.noun != null) {
	nouns = json.noun.syn;
}
if (json.adjective != null) {
	adjectives = json.adjective.syn;
}
if (json.adverb != null) {
	adverbs = json.adverb.syn;
}

response = response.concat(verbs, nouns, adjectives, adverbs);

var i = 0;
var container = document.getElementById('div2');
if (container.childNodes.length > 3) {
    container.removeChild(container.childNodes[3]);
}
var div = document.createElement('div');
div.setAttribute('class', 'output');
var list = document.createElement('ul');
list.setAttribute('id', 'output2');
list.addEventListener('click', (function() {
    makerequest(2);
    })
);

container.appendChild(div);
div.appendChild(list);

while (list.firstChild) {
    list.removeChild(list.firstChild);
}

response = response.filter(function(v) 
						   { return v.indexOf(' ') == -1; 
						   });

permute(response);

while (i < 4) {
	var item = document.createElement('li');
	item.innerHTML = response[i];
	list.appendChild(item);
	i++;
	}
}

function permute(array) {
	var n = array.length - 1;
	while (n > 0) {
		var i = Math.floor(Math.random()*n);
		var temp  = array[n];
		array[n] = array[i];
		array[i] = temp;
		n--;
	}
}

function makerequest(x) {
	var head = document.getElementsByTagName('head')[0];
	var script = document.createElement('script');
	var div = "word" + x;
	var request = 'http://words.bighugelabs.com/api/2/40868e50c339e2dcdaa54d041dffbf88/' + document.getElementById(div).value + '/json?callback=processResponse' + x; 
	script.type = 'text/javascript';
	script.src = request;
	head.appendChild(script);
}

</script>
</head>

<body>
<div id="header">
    <div id="header-inner">
        <a href="/">Syntext</a>
    </div>
</div>
<div id="content">
<div id="div0">
	<div class="word">
		<input type="text" / id = "word0">
	</div>
</div>
<div id="div1">
	<div class="word">
		<input type="text" id="word1" /> 
	</div>
</div>
<div id="div2">
	<div class="word">
		<input type="text" id="word2" /> 
	</div>
</div>
<div id="output">
</div>
<div id="buttons">
	<button type="button" onclick="getSynonym()">Get Synonyms</button>
	<button type="button" onclick="makeNames()"> Create! </button>
</div>
</div>
</div>
</body>
</html>
